window.Stately={},function(a){function b(a,b){var c=new a;return c.init(b),c}function c(a,d){d||(d=a,a=null);var e=d.hasOwnProperty("constructor")?d.constructor:function(){};if(a){var f=function(){};f.prototype=a.prototype,e.prototype=new f,e.sc=a.prototype}else e.prototype={};for(var g in d)e.prototype[g]=d[g];return e.prototype.constructor=e,e.extend=c.bind(null,e),e.create=b.bind(null,e),e}a.Class=c}(Stately),function(a){return"use strict",a.Command=a.Class({init:function(a){if(!a.callback)throw"callback required";this.callback=a.callback,this.options=a.options||{}},run:function(){this.callback(this.options,this.momento)},storeMomento:function(a){this.momento=a}}),a.Command}(Stately),function(a){function c(a,c,d){var e=b.create({callback:a,options:c});return e.saveable=d,e}"use strict";var b=a.Command;a.StateMachine=a.Class({init:function(){this.history=[],this.subscriptions=[]},storeMomento:function(a){if(!this.currentState)throw"no current state to store momento";this.currentState.storeMomento(a)},gotoState:function(a,b,d){typeof a!="boolean"&&(d=b,b=a,a=!0);var e=this.currentState;e&&e.saveable&&this.history.push(e),e=this.currentState=c(b,d,a),e.run()},replaceState:function(a,b,d){if(!this.currentState)throw"no current state to replace";typeof a!="boolean"&&(d=b,b=a,a=!0);var e=this.currentState=c(b,d,a);e.run()},continueState:function(a,b){if(!this.currentState)throw"no current state to continue";var d=c(a,b,!1);d.run()},popState:function(){var a=this.history.pop();if(!a)throw"empty history, cannot popState";a.saveable&&(this.currentState=a),a.run()}})}(Stately)